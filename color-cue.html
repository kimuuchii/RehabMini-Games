<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <title>Color Cue Trainer</title>
  <script defer src="shared.js"></script>
  <style>
    /* ‡πÉ‡∏ä‡πâ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
    /* (‡∏ï‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô‚Äî‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) */
    *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f0f0f0;touch-action:manipulation;overflow:hidden;height:100vh;width:100vw}
    .container{padding:20px;max-width:500px;margin:0 auto;overflow-y:auto;height:100vh}
    h1{text-align:center;color:#333;margin-bottom:30px;font-size:24px}
    .section{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
    .section-title{font-size:16px;font-weight:600;margin-bottom:15px;color:#555}
    .color-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-bottom:10px}
    .color-item{display:flex;flex-direction:column;align-items:center;cursor:pointer}
    .color-swatch{width:70px;height:70px;border-radius:50%;border:4px solid transparent;transition:.2s;box-shadow:0 2px 4px rgba(0,0,0,.2)}
    .color-item.selected .color-swatch{border-color:#333;transform:scale(1.1)}
    .color-name{margin-top:8px;font-size:14px;color:#666}
    .input-group{margin-bottom:15px}
    label{display:block;margin-bottom:8px;font-size:14px;color:#555}
    input[type="number"]{width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px}
    .checkbox-group{display:flex;flex-direction:column;gap:12px}
    .checkbox-item{display:flex;align-items:center;cursor:pointer}
    .checkbox-item input{width:22px;height:22px;margin-right:10px}
    .button-group{display:flex;flex-direction:column;gap:12px;margin-top:20px}
    button{padding:16px;font-size:16px;font-weight:600;border:none;border-radius:10px;cursor:pointer}
    .btn-primary{background:#007AFF;color:#fff}.btn-secondary{background:#5856D6;color:#fff}.btn-danger{background:#FF3B30;color:#fff}
    .play-screen{display:none;position:fixed;inset:0;justify-content:center;align-items:center;flex-direction:column;transition:background-color .5s}
    .play-screen.active{display:flex}
    .color-label{font-size:48px;font-weight:800;color:#fff;text-shadow:2px 2px 8px rgba(0,0,0,.5);text-align:center;padding:20px}
    .timer-display{position:absolute;top:20px;left:20px;font-size:28px;font-weight:700;color:#fff;text-shadow:0 2px 4px rgba(0,0,0,.5);background:rgba(0,0,0,.3);padding:10px 20px;border-radius:10px}
    .close-btn{position:absolute;top:20px;right:20px;background:rgba(255,255,255,.3);color:#fff;border:none;padding:12px 24px;border-radius:8px;font-weight:600}
    .countdown-screen{font-size:120px;font-weight:800;color:#fff;text-shadow:4px 4px 12px rgba(0,0,0,.7);animation:pulse 1s infinite}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
    .error{color:#FF3B30;font-size:14px;margin-top:10px;display:none}.error.show{display:block}
  </style>
</head>
<body>
  <div class="container" id="settingsScreen">
    <h1>üé® Color Cue Trainer</h1>
    <div class="section">
      <div class="section-title">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏° (2-6 ‡∏™‡∏µ)</div>
      <div class="color-grid" id="colorGrid"></div>
      <div class="error" id="colorError">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏™‡∏µ</div>
    </div>
    <div class="section">
      <div class="section-title">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤ & ‡πÇ‡∏´‡∏°‡∏î</div>
      <div class="input-group">
        <label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
        <input type="number" id="timeInput" min="1" max="30" value="5">
      </div>
      <div class="checkbox-group">
        <div class="checkbox-item"><input type="checkbox" id="voiceCheck" checked><label for="voiceCheck">‡∏û‡∏π‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏µ</label></div>
        <div class="checkbox-item"><input type="checkbox" id="randomCheck" checked><label for="randomCheck">‡∏™‡∏∏‡πà‡∏°‡∏™‡∏µ</label></div>
        <div class="checkbox-item"><input type="checkbox" id="tapCheck" checked><label for="tapCheck">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</label></div>
      </div>
    </div>
    <div class="button-group">
      <button class="btn-primary" onclick="startGame()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°</button>
      <button class="btn-secondary" onclick="previewColor()">üëÅÔ∏è ‡∏•‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏°‡∏™‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
      <a class="btn-danger" href="index.html" style="text-align:center;display:block">‚Ü©Ô∏é ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°</a>
    </div>
  </div>

  <div class="play-screen" id="playScreen">
    <div class="timer-display" id="timerDisplay">5</div>
    <button class="close-btn" onclick="stopGame()">‡∏õ‡∏¥‡∏î</button>
    <div class="color-label" id="colorLabel"></div>
  </div>

<script>
const COLORS = [
  { name:'‡πÅ‡∏î‡∏á', nameEng:'red', hex:'#FF3B30' },
  { name:'‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á', nameEng:'yellow', hex:'#FFCC00' },
  { name:'‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß', nameEng:'green', hex:'#34C759' },
  { name:'‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô', nameEng:'blue', hex:'#007AFF' },
  { name:'‡∏™‡πâ‡∏°', nameEng:'orange', hex:'#FF9500' },
  { name:'‡∏°‡πà‡∏ß‡∏á', nameEng:'purple', hex:'#AF52DE' }
];
let gameInterval=null, currentTime=0;
const settings={ colors:[0,1,2], time:5, voice:true, random:true, tap:true };

function initColorGrid(){
  const grid=$('#colorGrid');
  COLORS.forEach((c,i)=>{
    const item=document.createElement('div'); item.className='color-item';
    if(settings.colors.includes(i)) item.classList.add('selected');
    item.innerHTML=`<div class="color-swatch" style="background:${c.hex}"></div><div class="color-name">${c.name}</div>`;
    item.onclick=()=> toggleColor(i,item); grid.appendChild(item);
  });
}
function toggleColor(i,el){
  const k=settings.colors.indexOf(i);
  if(k>-1){ settings.colors.splice(k,1); el.classList.remove('selected'); }
  else { if(settings.colors.length<6){ settings.colors.push(i); el.classList.add('selected'); } }
  $('#colorError').classList.remove('show');
}
function previewColor(){
  if(settings.colors.length<2){ $('#colorError').classList.add('show'); return; }
  const idx=settings.colors[Math.floor(Math.random()*settings.colors.length)];
  const c=COLORS[idx];
  const ps=$('#playScreen'); ps.style.backgroundColor=c.hex; $('#colorLabel').textContent=c.name;
  $('#timerDisplay').style.display='none'; ps.classList.add('active'); if($('#voiceCheck').checked) speak(c.name);
  setTimeout(()=>{ ps.classList.remove('active'); $('#timerDisplay').style.display='block'; },1500);
}
function startGame(){
  if(settings.colors.length<2){ $('#colorError').classList.add('show'); return; }
  settings.time=+$('#timeInput').value||5; settings.voice=$('#voiceCheck').checked;
  settings.random=$('#randomCheck').checked; settings.tap=$('#tapCheck').checked;
  $('#settingsScreen').style.display='none'; $('#playScreen').classList.add('active');
  countdownOverlay(3, ()=> startColorGame());
}
function startColorGame(){
  const selected=settings.colors.map(i=>COLORS[i]);
  let currentIndex=0, lastIndex=-1;
  function showNext(){
    if(settings.random){
      let j; do{ j = Math.floor(Math.random()*selected.length); }while(selected.length>1 && j===lastIndex);
      currentIndex=j; lastIndex=j;
    }else{
      currentIndex=(currentIndex+1)%selected.length;
    }
    const c=selected[currentIndex];
    $('#playScreen').style.backgroundColor=c.hex; $('#colorLabel').textContent=c.name;
    if(settings.voice) speak(c.name);
    currentTime=settings.time; updateTimer();
  }
  function updateTimer(){ $('#timerDisplay').textContent=`${currentTime} ‡∏ß‡∏¥`; }
  showNext();
  clearInterval(gameInterval);
  gameInterval=setInterval(()=>{
    currentTime--; updateTimer();
    if(currentTime<=0) showNext();
  },1000);
  if(settings.tap){
    $('#playScreen').onclick=(e)=>{ if(e.target.id==='playScreen'||e.target.id==='colorLabel'){ showNext(); } };
  }
}
function stopGame(){ clearInterval(gameInterval); $('#playScreen').classList.remove('active'); $('#playScreen').onclick=null; $('#settingsScreen').style.display='block'; }
window.onload=initColorGrid;
</script>
</body>
</html>
